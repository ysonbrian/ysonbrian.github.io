---
date: '2021-11-18'
title: '블록체인의 합의 알고리즘'
categories: ['BlockChain']
summary: '다양한 합의 알고리즘을 알아보자'
thumbnail: './block1.jpeg'
---

# 블록체인의 합의 알고리즘

## 1. 합의 알고리즘은 무엇인가?

- 합의 알고리즘은 블록체인 네트워크에서 분산화된 시스템의 무결성과 보안을 유지시키는 역할을 함
- 사토시 나카모토에 의해 설계된 작업증명(PoW, Proof of Work)은 비트코인에 적용된 합의 알고리즘으로써 비잔티움 장애를 극복하기 위해 적용됨

### 합의 알고리즘

블록체인은 분산화된 시스템으로 구성되어 있으며, 탈중앙화 형태 이므로 분산화된 노드는 트랜잭션 유효성에 합의가 필요한데 이때 합의 알고리즘이 사용된다. 합의 알고리즘은 코인이 한번만 사용되도록 모든 트랜잭션이 신뢰할 수 있는 방식으로 진행되는 것을 보장한다. 흔히 프로토콜과 합의 알고리즘을 바꿔서 사용하는데 이것은 틀린 것이다. 프로토콜은 블록체인의 기본 규칙이며 알고리즘은 이러한 규칙을 따르는 메커니즘이다. 비트코인과 이더리움은 프로토콜이고, 작업 증명과 지분증명(PoS, Proof of Stake)는 이들의 합의 알고리즘 이다.

### 작업 증명 (PoW, Proof of Work)

작업 증명은 처음으로 만들어진 합의 알고리즘이며 높은 해시 레이트를 가진 마이너가 다음 블록 해시를 가질 가능성이 더 높은데 이것은 많은 연산을 요구하며 트랜잭션이 아주 힘들게 이루지므로 화폐의 인플레이션을 예방하고자 하였다. 또한 모든 작업이 많은 에너지를 요구하는데 이것은 화폐의 가치를 떨어트리지 않게 하며 블록해시를 동시에 찾더라도 Longest Chain 법칙에 의하여 더 긴 노드로 이루어진 노드를 선택하므로써 합의 알고리즘의 가장 문제점인 이중지불을 할 수 없도록 하였다.

### 지분 증명(PoS, Proof of Stake)

지분 증명 합의 알고리즘은 작업증명의 대안으로 개발되었다. 지분 증명은 작업 증명과 유사한 목표를 공유하지만, 몇가지 차이가 있다. 지분 증명 합의 알고리즘은 마이닝 과정을 가장 많은 지분을 가진 참여자가 블록을 검증하는 방식이다. 할당된 연산 능력이 요구되지 않으므로 전력을 낭비 할 필요 없으며 환경친화적 이다. 현재 작업 증명은 소수의 채굴풀에 해시가 집중 되는 방식이므로 또다른 중앙화를 야기하고 있기에 지분 증명이 좀 더 탈중앙화에 적합한 대안일 수 있다. 하지만 체인 선택 외에 나머지 문제점의 해결방안을 찾지 못하였고, 암호화폐 보유량에 비례하여 자금을 배당하므로 소수의 사람들에게 자금이 집중 될 수있는 문제가 있다. Nothing at stake problem이 최대 문제점인데 이것은 지분을 가장 많이 가진 노드가 2개의 체인이 분기가 일어날 때 악의적인 노드가 참인 것처럼 참여하여 체인을 형성 할 수가 있다. 그 때 검증자는 어떤 블록체인이 정당한지 알 수 없다. 거짓인 블록체인에 합의한 경우 모두 공격 당할 수 있다.

### 이중 지불

이중 지불은 동일한 자금이 한번 이상 사용되는 것인데, 가령 참여 노드가 블록 해시를 찾았을 경우 비트코인 블록체인 상에 블록이 등록되려면 1시간후 등록되는데, 구매자와 판매자가 블록체인 상에 올라가기전에 블록 해시만 찾았을 때 판매자가 구매자에게 물건을 판매 한다면 구매자가 해당 블록해시를 고아 노드로 만들게 되면 블록체인 상에 올라가지 못하여 판매자는 물건을 팔았지만 암호화폐를 받지 못하는 경우가 생긴다. 하지만 비트코인에서는 작업 증명 합의 알고리즘을 사용하므로 새로운 노드를 생성하기엔 엄청난 노력이 요구된다. 악의적인 노드가 다른 트랜잭션으로 바꿔치기를 하려고 해도 이미 트랜잭션이 일어난 노드는 블록체인 상에서 다른 노드에게 전파하고 있으므로 결론적으론 악의적인 노드가 속도를 따라갈 수 없다. 대표적으로 51% 공격이 있는데 해시 레이트를 50% 이상을 가진 악의적인 노드가 트랜잭션을 배제하거나 그 순서를 조작 할 수 있게 되는 것인데 비트코인 50%의 노드들을 전부 바꾼다고 하여도 바꾼 50%의 비용이 전체 비트코인 50% 가격보다 더 많으므로 사실상 의미가 없다. 하지만 비트코인이 아닌 다른 네트워크에서는 충분히 일어날 수 있으므로 적절한 합의 알고리즘과 메커니즘이 요구된다.

## 마치며

작업 증명은 이중 지불 문제의 해결책이었으며, 신뢰 할 수 있고 안전한 것으로 증명 되었다. 비트코인은 합의 알고리즘을 사용하여 탈중앙화 시스템에서도 잘 작동하도록 구현 되었다. 비트코인은 블록체인 기술을 더욱 발전 시켰으며 더 나아가 자금수단으로만 이용됐던 탈중앙화 프로토콜에서 프로그래밍 가능한 dApp(분산 애플리케이션) 이더리움이 탄생하였고, 오늘날 많은 블록체인 서비스는 비트코인과 이더리움의 생태계로 이루어져 있다.
