---
date: '2021-12-11'
title: 'Solidityë¥¼ ì´ìš©í•œ ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„'
categories: ['BlockChain']
summary: 'Solidityë¥¼ ì´ìš©í•˜ì—¬ ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ì„ ë§Œë“¤ì–´ë³´ê³  ê°œì„  í•´ë³´ì!'
thumbnail: './block6.png'
---

# Solidityë¥¼ ì´ìš©í•œ ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„

---

ë¸”ë¡ì²´ì¸ ë„¤íŠ¸ì›Œí¬ì— ìš°ë¦¬ê°€ ì‘ì„±í•œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë ‰íŠ¸ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ì„  íŠ¹ìˆ˜í•œ ì–¸ì–´ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë° ì´ ì–¸ì–´ëŠ” ì–´ì¹´ìš´íŠ¸ ì£¼ì†Œ, ê·œì¹™ ì‚¬ì–‘, íŠ¸ëœì­ì…˜ ë˜ëŒë¦¼ê³¼ ê°™ì€ ë¸”ë¡ì²´ì¸ì— íŠ¹í™”ëœ í‹ì • ê¸°ëŠ¥ì´ ì–¸ì–´ì— ë‚´ì¥ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ê²ƒì„ ì¶©ì¡±ì‹œì¼œì£¼ëŠ” ì–¸ì–´ëŠ” ì–´ë–¤ê²Œ ìˆì„ê¹Œìš”?

#### Solidity íŠ¹ì§•

- ê°ì²´ì§€í–¥ ê³ ìˆ˜ì¤€ ì–¸ì–´ì´ë©° C++, íŒŒì´ì¬, ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì˜í–¥ì„ ë°›ì•˜ìŒ
- ì •ì íƒ€ì…, ìƒì†, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì‚¬ìš©ì ì •ì˜ íƒ€ì… ë“±ì„ ì§€ì›
- ë¸”ë¡ì²´ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ìœ„í•œ ìœ ìš©í•œ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µ

ì˜¤ëŠ˜ë‚  ëŒ€ë¶€ë¶„ì˜ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ëŠ” Solidityë¥¼ ì‚¬ìš© í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ê¼­ ë°°ì›Œì•¼ ê² ì£ ? ğŸ˜‰

ì˜¤ëŠ˜ì€ **solidity** ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•œ ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.
ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ì„ ë§Œë“¤ê¸° ìœ„í•´ì„  ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì½”ë“œë¥¼ ë°°í¬í•˜ê³  í…ŒìŠ¤íŠ¸ í•´ì•¼ ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì—¬ëŸ¬ í†µí•© ê°œë°œ í™˜ê²½(Truffle, Ganache.. etc)ì´ ìˆì§€ë§Œ Remixë¼ëŠ” í†µí•© ê°œë°œ í™˜ê²½ì„ ì´ìš©í•´ì„œ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.

---

#### ê°€ìœ„ë°”ìœ„ë³´ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸

##### ê²Œì„ë°©ë²•

ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì²˜ìŒ ë§Œë“  ì‚¬ëŒì´ ë°©ì¥ì´ ë˜ê³  ë°©ì¥ì´ ê°€ìœ„ ë°”ìœ„ ë³´ ì…‹ì¤‘ì— í•˜ë‚˜ì˜ ê°’ê³¼ ether, gwei, ë˜ëŠ” wei ê°’ì„ ì»¨íŠ¸ë™íŠ¸ì— ì €ì¥í•˜ê³  ì°¸ê°€ìë„ ë§ˆì°¬ê°€ì§€ë¡œ ì§„í–‰í•˜ê³  ë‘˜ì¤‘ ì´ê¸´ ì‚¬ëŒì´ ì»¨íŠ¸ë™íŠ¸ì— ë‹´ê¸´ ëª¨ë“  í™”íë¥¼ ê°€ì ¸ê°€ëŠ” ê°„ë‹¨í•œ ê²Œì„

ëª¨ë“  ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/ysonbrian/block-smart-contract/blob/master/contract/RPS.sol) ìˆìŠµë‹ˆë‹¤!

ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ì—ì„œ ê°€ì¥ í•µì‹¬ì ì¸ í•¨ìˆ˜ë§Œ ì§šê³  ë„˜ì–´ê°€ ë³´ê² ìŠµë‹ˆë‹¤ ğŸ˜

```solidity
function createRoom(Hand _hand)
    public
    payable
    isValidHand(_hand)
    returns (uint256 roomNum)
  {
    // ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§Œë“  ì‚¬ëŒì´ ê²Œì„ ì£¼ì¸ì´ë©° ì»¨íŠ¸ë™íŠ¸ë¥¼ ìƒì„±ê³¼ ë™ì‹œì— ìì‹ ì˜ ê°€ìœ„ë°”ìœ„ë³´ë¥¼ í•˜ë‚˜ ì„¤ì •í•˜ì—¬ ì»¨íŠ¸ë™íŠ¸ì— ì €ì¥!
    rooms[roomLen] = Game({
      betAmount: msg.value, // ì´ ê²Œì„ì— ë°°íŒ…í•œ ì´ ê¸ˆì•¡ ... ì²˜ìŒì—” ë°©ì¥ì´ ëˆì„ ë„£ëŠ”ë‹¤
      gameStatus: GameStatus.STATUS_NOT_STRTED, // ê²Œì„ ìƒíƒœ
      originator: Player({ // originatorëŠ” ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì²˜ìŒ ë§Œë“  ì´ ê²Œì„ì˜ ì£¼ì¸ì„ ë‚˜íƒ€ëƒ„
        hand: _hand, // ê°€ìœ„ ë°”ìœ„ ë³´ ì…‹ì¤‘ í•˜ë‚˜
        addr: payable(msg.sender), // ë°©ì¥ ì–´ì¹´ìš´íŠ¸ ì£¼ì†Œ
        playerStatus: PlayerStatus.STATUS_PENDING, // ë°©ì¥ ìƒíƒœ
        playerBetAmount: msg.value // ë°©ì¥ì´ ë‚¸ ê¸ˆì•¡
      }),
      taker: Player({ // takerëŠ” ì°¸ì—¬ìë¥¼ ë‚˜íƒ€ëƒ„
        hand: Hand.rock, // ë””í´íŠ¸ë¡œ ì°¸ì—¬ì ì •ë³´ë¥¼ ì„¸íŒ…
        addr: payable(msg.sender), // ì´ˆê¸° ì„¸íŒ…ì€ ë°©ì¥ì˜ ì£¼ì†Œ.. ì°¸ì—¬ìê°€ ì°¸ì—¬í•˜ë©´ ë°”ë€œ
        playerStatus: PlayerStatus.STATUS_PENDING, // ì°¸ì—¬ìì˜ ìƒíƒœ
        playerBetAmount: 0 // ì°¸ì—¬ìê°€ ì—†ê¸°ë•Œë¬¸ì— ì´ˆê¸° ê°’ì€ 0
      })
    });
    roomNum = roomLen;
    roomLen = roomLen + 1; // ë°©ì€ ì—¬ëŸ¬ê°œê°€ ìƒì„± ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°© ìƒì„±ì‹œ ìë™ìœ¼ë¡œ ì¦ê°€
  }
```

```solidity
function joinRoom(uint256 roomNum, Hand _hand)
    public
    payable
    isValidHand(_hand) // ì°¸ì—¬ìì˜ ê°€ìœ„ ë°”ìœ„ ë³´ ê°’ì„ í™•ì¸
  {
    rooms[roomNum].taker = Player({ // ì‹¤ì§ˆì ìœ¼ë¡œ ì°¸ì—¬ìê°€ ê²Œì„ì— ì°¸ì—¬ í•˜ë©´ì„œ ì •ë³´ê°€ ë‹´ê¹€
      hand: _hand, // ê°€ìœ„ ë°”ìœ„ ë³´
      addr: payable(msg.sender), // ì°¸ì—¬ì ì£¼ì†Œ
      playerStatus: PlayerStatus.STATUS_PENDING, // ì°¸ì—¬ì ìƒíƒœ
      playerBetAmount: msg.value // ì°¸ì—¬ìì˜ ë°°íŒ… ê¸ˆì•¡
    });
    rooms[roomNum].betAmount = rooms[roomNum].betAmount + msg.value; // ì°¸ì—¬ê°€ ì™„ë£Œ ë˜ë©´ ê²Œì„ë°©ì˜ ë°°íŒ… ê¸ˆì•¡ì— ì°¸ì—¬ì ë°°íŒ…ì„ ë”í•¨
    compareHands(roomNum); // ë°©ì¥ê³¼ ì°¸ì—¬ìì˜ ê²°ê³¼ë¥¼ í™•ì¸
  }
```

```solidity
function compareHands(uint256 roomNum) private {
    uint8 originator = uint8(rooms[roomNum].originator.hand); // ë°©ì¥ì´ ë‚¸ ê°€ìœ„ ë°”ìœ„ ë³´ ê°’ì„ í™•ì¸
    uint8 taker = uint8(rooms[roomNum].taker.hand); // ì°¸ì—¬ìì˜ ê°€ìœ„ ë°”ìœ„ ë³´ ê°’ì„ í™•ì¸

    rooms[roomNum].gameStatus = GameStatus.STATUS_STARTED; // ê²Œì„ì´ ì‹œì‘í•¨ì„ ì•Œë¦¼

    if (taker == originator) {
      // ë¹„ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_TIE;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_TIE;
    } else if ((taker + 1) % 3 == originator) {
      // ë°©ì¥ì´ ì´ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_WIN;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_LOSE;
    } else if ((originator + 1) % 3 == taker) {
      // ì°¸ê°€ìê°€ ì´ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_LOSE;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_WIN;
    } else {
      // ê·¸ ì™¸ì˜ ìƒí™©ì—ëŠ” ê²Œì„ ìƒíƒœë¥¼ ì—ëŸ¬ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤
      rooms[roomNum].gameStatus = GameStatus.STATUS_ERROR;
    }
  }

  modifier isPlayer(uint256 roomNum, address sender) { // ë°©ì¥ ë˜ëŠ” ì°¸ì—¬ìì˜ ì£¼ì†Œê°€ ë§ëŠ”ì§€ í™•ì¸
    require(
      sender == rooms[roomNum].originator.addr ||
        sender == rooms[roomNum].taker.addr
    );
    _;
  }

```

```solidity
function payout(uint256 roomNum) // ê²Œì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ë°°íŒ…ì„ ì •ì‚°
    public
    payable
    isPlayer(roomNum, msg.sender)
  {
    if ( // ë¹„ê¸°ëŠ” ê²½ìš°
      rooms[roomNum].originator.playerStatus == PlayerStatus.STATUS_TIE &&
      rooms[roomNum].taker.playerStatus == PlayerStatus.STATUS_TIE
    ) {
      rooms[roomNum].originator.addr.transfer(
        rooms[roomNum].originator.playerBetAmount
      );
      rooms[roomNum].taker.addr.transfer(rooms[roomNum].taker.playerBetAmount);
    } else {
      if (rooms[roomNum].originator.playerStatus == PlayerStatus.STATUS_WIN) {// ë°©ì¥ì´ ì´ê¸°ëŠ” ê²½ìš°
        rooms[roomNum].originator.addr.transfer(rooms[roomNum].betAmount);
      } else if (rooms[roomNum].taker.playerStatus == PlayerStatus.STATUS_WIN) { // ì°¸ì—¬ìê°€ ì´ê¸°ëŠ” ê²½ìš°
        rooms[roomNum].taker.addr.transfer(rooms[roomNum].betAmount);
      } else { // ë‘˜ë‹¤ ì•„ë‹Œê²½ìš°
        rooms[roomNum].originator.addr.transfer(
          rooms[roomNum].originator.playerBetAmount
        );
        rooms[roomNum].taker.addr.transfer(
          rooms[roomNum].taker.playerBetAmount
        );
      }
    }
    rooms[roomNum].gameStatus = GameStatus.STATUS_COMPLETE; // ê²Œì„ì´ ì¢…ë£Œë˜ì—ˆìœ¼ë¯€ë¡œ ê²Œì„ ìƒíƒœ ë³€ê²½
  }
```

---

### ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ ì‹¤í–‰

1. ë°©ì„ ë§Œë“ ë‹¤

   ![](../../ydblog/contents/createRoom.gif)
   ë°©ì¥ì€ ê²Œì„ë°©ì„ ìƒì„±í•˜ê³  ê°€ìœ„ ë°”ìœ„ ë³´ ê°’ì¤‘ì— í•˜ë‚˜ë¥¼ ë„£ëŠ”ë‹¤. ì´ ì˜ˆì‹œ ì—ì„œëŠ” ì£¼ë¨¹ì„ ë„£ì—ˆê³  ì¶”ê°€ë¡œ 10 ì´ë” ê°’ì„ ë„£ì—ˆë‹¤

2. ì°¸ì—¬ì ì…ì¥
   ![playerEnter](../../ydblog/contents/playerEnter.gif)
   ì²« ë°©ì„ ìƒì„±í•˜ë©´ 0 ë²ˆì§¸ ë¶€í„° ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— 0 ê°’ì„ ë„£ì–´ì£¼ê³  ë°©ì¥ì„ ì´ê¸°ëŠ” ì¡°ê±´ìœ¼ë¡œ ë°”ìœ„ì™€ 10 ì´ë”ë¥¼ í•¨ê»˜ íŠ¸ëœì­ì…˜ì„ í•´ì£¼ì—ˆë‹¤

3. ê²°ê³¼ í™•ì¸
   ![endGame](../../ydblog/contents/endGame.gif)
   ë°©ì¥ì´ payoutì„ ëˆ„ë¥´ë©´ ê²°ê³¼ê°’ì„ í™•ì¸ í•  ìˆ˜ ìˆëŠ”ë° ì´ ì˜ˆì‹œì—ì„œëŠ” ì°¸ì—¬ìê°€ ì´ê¸°ëŠ” ì¡°ê±´ìœ¼ë¡œ ì§„í–‰ í–ˆê¸° ë•Œë¬¸ì— 2ë²ˆì§¸ ì–´ì¹´ìš´íŠ¸ì— 20 ì´ë”ê°€ ì¶”ê°€ ëœ ê²ƒì„ í™•ì¸í–ˆë‹¤.

#### ì ê¹! ë­”ê°€ ë¬¸ì œê°€ ìˆëŠ”ë°?ğŸ˜±

![canSee](../../ydblog/contents/canSee.gif)
ë¡­ìŠ¤í…ì— ë°°í¬í›„ ë°©ì¥ì´ ë‚¸ ê°€ìœ„ ë°”ìœ„ ì •ë³´ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤ë‹ˆ..?? ì´ëŸ¬ë©´ ì°¸ì—¬ìê°€ ë¬´ì¡°ê±´ ì´ê¸°ëŠ” ê²Œì„ì´ ëœë‹¤!!

### ì‹¬ê°í•œ ì˜¤ë¥˜ë¥¼ ë°œê²¬! ê°œì„  í•´ë³´ì! ğŸ§‘ğŸ»â€ğŸ’»

ëª¨ë“  ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ëŠ” ë¸”ë¡ì²´ì¸ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¼ê°€ë©´ ëª¨ë“  ì •ë³´ë¥¼ ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë³´ì•ˆì„ ë¬´ì¡°ê±´ ì‹ ê²½ ì¨ì£¼ì–´ì•¼ í•˜ëŠ”ë° ìš°ë¦¬ê°€ ë§Œë“  ê°€ìœ„ë°”ìœ„ë³´ì˜ ê²Œì„ì€ ë°©ì¥ì˜ ì„ íƒì„ ëˆ„êµ¬ë‚˜ í™•ì¸ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°©ì¥ì˜ ëˆì„ ë¬´ì¡°ê±´ ê°€ì ¸ê°ˆ ìˆ˜ ìˆëŠ” ê²Œì„ì´ ë˜ì—ˆë‹¤.
ì •ë³´ë¥¼ ê°ì¶”ê¸° ìœ„í•´ ê³ ë¯¼ì„ í•´ë³´ì•˜ê³  ì—¬ëŸ¬ ë¦¬ì„œì¹˜ë¥¼ í†µí•´ í•œê°€ì§€ ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤. Solidityì—ì„œ ì œê³µí•˜ëŠ” **keccak256**ì´ë¼ëŠ” í•¨ìˆ˜ëŠ” ë°ì´í„°ì˜ ê°’ì„ í•´ì‹œë¡œ ì•”í˜¸í™” í•˜ì—¬ ê³ ì •ëœ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ëŠ”ë° ì´ ê°’ì„ ë°”ì´íŠ¸ ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ë©´ ë¸”ë¡ì²´ì¸ ë„¤íŠ¸ì›Œí¬ì— ì˜¬ë¼ê°€ë„ ë°”ì´íŠ¸ê°’ìœ¼ë¡œ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì— ì°¸ì—¬ìê°€ ì–´ë–¤ ê°’ì¸ì§€ í™•ì¸ í•  ìˆ˜ê°€ ì—†ë‹¤.

Keccak256 í•¨ìˆ˜ì— abi.encodePacked(first, second)ë¥¼ ë„£ì–´ì£¼ë©´ ë°ì´í„° ê°’ì„ í•´ì‹œí™” í•˜ì—¬ ë¦¬í„´ í•´ì£¼ëŠ”ë° first ì™€ second ê°’ì€ string, bytes ë˜ëŠ” uint ìë£Œí˜•ìœ¼ë¡œ êµ¬ì„±í•´ì•¼ í•˜ë©° ê° ê°’ì¤‘ì— í•˜ë‚˜ëŠ” ê°ì¶”ê³  ì‹¶ì€ ë°ì´í„°ì™€ ë‹¤ë¥¸ ê°’ì€ ëœë¤í•œ ê°’ì„ ë„£ì–´ì£¼ë©´ ê¸°ë³¸ í•´ì‹œ + salt**(Brute Force Attack (ë¬´ì‘ìœ„ ê³µê²©**)ì„ ì˜ˆë°©í•˜ì—¬ ê¸°ë³¸ í•´ì‹œê°’ì— ë‹¤ë¥¸ ëœë¤ ê°’ì„ ë”í•´ì£¼ëŠ” ê°œë…) í•˜ì—¬ ì•”í˜¸í™” í•  ìˆ˜ ìˆë‹¤. Solidty ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œëŠ” ë§Œì•½ first ì™€ second ê°’ì´ 'A' + 'BB' ì´ê±°ë‚˜ 'AB' + 'B' ì´ë¼ë©´ ë™ì¼í•œ ê°’ì„ ë¦¬í„´í•œë‹¤ê³  í•˜ì—¬ ì‚¬ìš©í•˜ëŠ”ë° ì£¼ì˜ í•˜ë¼ í•˜ì˜€ì§€ë§Œ ë°©ì¥ì€ ì²˜ìŒ ê²Œì„ì„ ë§Œë“¤ë•Œ ê°€ìœ„ë°”ìœ„ë³´ ê°’ì´ ì•„ë‹Œ í•´ì‰¬ëœ ê°’ì„ ë„£ê³  ë§Œë“¤ë©´ ì°¸ì—¬ìëŠ” ë°©ì¥ì˜ 2ë²ˆì§¸ ê°’ì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ê´œì°®ë‹¤ê³  ìƒê°í–ˆë‹¤.

ê°œì„ ëœ ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/ysonbrian/block-smart-contract/blob/master/contract/rpsAdvanced.sol) ìˆìŠµë‹ˆë‹¤!

```solidity
function hashFunction(uint256 _hand, string memory _secret)
    public
    pure
    returns (bytes32)
  {
    return keccak256(abi.encodePacked(_hand, _secret)); // í•´ì‹œëœ ë°”ì´íŠ¸ê°’
  }
```

ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„ì„ ì²˜ìŒ ë””í”Œë¡œì´ í•˜ë©´ ë°©ì¥ì€ hashFunctionì„ ì‚¬ìš©í•˜ì—¬ í•¸ë“œ ê°’ê³¼ ê°œì¸ ë¹„ë°€ê°’ì„ ë„£ì–´ì„œ ë°˜í™˜ëœ byte ê°’ì„ ê²Œì„ ìƒì„±í• ë•Œ ê°’ìœ¼ë¡œ ë„£ì–´ì¤€ë‹¤.

```solidity
function compareHands(
    uint256 roomNum,
    uint256 _hand,
    string memory _secret
  ) private {
    uint256 originator;
    uint256 taker;
    bytes32 validateHand = keccak256(abi.encodePacked(_hand, _secret)); // ë°©ì¥ì€ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì²˜ìŒì— ì…ë ¥í–ˆë˜ ê°’ë“¤ì„ ë„£ì–´ì¤€ë‹¤
    require( // ë°©ì¥ì´ ë‹¤ë¥¸ê°’ì„ ë„£ì„ ìˆ˜ ì—†ë„ë¡ ì…ë ¥ëœ ê°’ì´ ì²˜ìŒ ìƒì„±ëì„ë•Œ ê°’ê³¼ ê°™ì€ì§€ í™•ì¸
      validateHand == rooms[roomNum].originator.hand,
      'Creator Must submit right hand and secret'
    );
    originator = _hand;
    taker = uint8(rooms[roomNum].taker.hand);

    rooms[roomNum].gameStatus = GameStatus.STATUS_STARTED;

    if (taker == originator) {
      // ë¹„ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_TIE;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_TIE;
    } else if ((taker + 1) % 3 == originator) {
      // ë°©ì¥ì´ ì´ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_WIN;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_LOSE;
    } else if ((originator + 1) % 3 == taker) {
      // ì°¸ê°€ìê°€ ì´ê¸´ ê²½ìš°
      rooms[roomNum].originator.playerStatus = PlayerStatus.STATUS_LOSE;
      rooms[roomNum].taker.playerStatus = PlayerStatus.STATUS_WIN;
    } else {
      // ê·¸ ì™¸ì˜ ìƒí™©ì—ëŠ” ê²Œì„ ìƒíƒœë¥¼ ì—ëŸ¬ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤
      rooms[roomNum].gameStatus = GameStatus.STATUS_ERROR;
    }
  }

  modifier isPlayer(uint256 roomNum, address sender) {
    require(
      sender == rooms[roomNum].originator.addr ||
        sender == rooms[roomNum].taker.addr
    );
    _;
  }

```

ê¸°ì¡´ compareHands í•¨ìˆ˜ëŠ” ì°¸ì—¬ìê°€ joinRoom í•¨ìˆ˜ë¥¼ ì‹¤í–‰ í• ë•Œ ë§ˆì§€ë§‰ì— ì‹¤í–‰ ëì§€ë§Œ, ì´ í•¨ìˆ˜ë¥¼ ë°©ì¥ì´ ê²°ê´ê°’ì„ í™•ì¸í•  ë•Œ ì‹¤í–‰ í•˜ë©´ì„œ ê²Œì„ì˜ ê²°ê³¼ë¥¼ í™•ì¸í•˜ë„ë¡ ë°”ê¾¸ì—ˆë‹¤.
require êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ë°©ì¥ì´ ë§ˆìŒì´ ë°”ë€Œì–´ ë‹¤ë¥¸ê°’ì„ ì…ë ¥í•´ë„ ì´ˆê¸°ì— ì…ë ¥í•œ ê°’ìœ¼ë¡œë§Œ ê²Œì„ì´ ì§„í–‰í•˜ë„ë¡ êµ¬í˜„í•˜ì˜€ê³  ê²Œì„ì€ ë¬¸ì œ ì—†ì´ ì§„í–‰ í•  ìˆ˜ ìˆë‹¤.

![advancedCreateRoom](../../ydblog/contents/advancedCreateRoom.gif)
ë°©ì¥ì´ ì²˜ìŒ ë°©ì„ ë§Œë“¤ë©´ hashFunctionì„ ì‚¬ìš©í•˜ì—¬ ê°€ìœ„ ë°”ìœ„ ë³´ ê°’ê³¼ ë¹„ë°€ê°’ì„ ë„£ì–´ì£¼ë©´ í•´ì‹œê°’ì„ ì–»ì„ ìˆ˜ ìˆê³  ì´ ê°’ì„ ê·¸ëŒ€ë¡œ createRoom ê°’ì— ë„£ì–´ì¤€ë‹¤.
![advancedPlayerEnter](../../ydblog/contents/advancedPlayerEnter.gif)
ì°¸ì—¬ìëŠ” ì „ ê³¼ ë™ì¼í•˜ê²Œ ê°’ì„ ë„£ì–´ì¤€ë‹¤.
![advancedEndGame](../../ydblog/contents/advancedEndGame.gif)
ë°©ì¥ì´ payout í•¨ìˆ˜ë¥¼ ì‹¤í–‰ í•  ë•Œ ì²˜ìŒì— ì…ë ¥í–ˆë˜ ê°’ì„ ê·¸ëŒ€ë¡œ ë„£ì–´ì•¼ë§Œ ê²Œì„ì´ ëì´ ë‚œë‹¤.

![errorSituation](../../ydblog/contents/errorSituation.png)
ê¸°ì¡´ ê°’ì´ ì•„ë‹Œ ê°’ì„ ì…ë ¥í•˜ë©´ "Creator Must submit right hand and secret" ì´ë¼ëŠ” ë¬¸êµ¬ë¥¼ ë³´ì—¬ì£¼ë©° ì‹¤íŒ¨í•˜ê²Œ ëœë‹¤

![result](../../ydblog/contents/result.png)
ë¡­ìŠ¤í…ì— ì§ì ‘ ë°°í¬í•˜ì—¬ í™•ì¸í•´ë³´ë‹ˆ ì—­ì‹œë‚˜ ë°”ì´íŠ¸ê°’ìœ¼ë¡œ ì˜ ê°ì¶°ì§„ ê²ƒì„ í™•ì¸ í•  ìˆ˜ê°€ ìˆì—ˆë‹¤.

![gameResult](../../ydblog/contents/gameResult.png)
ì°¸ì—¬ìê°€ 200 weië¡œ ì°¸ì—¬í•˜ê³  ê²Œì„ì„ ìŠ¹ë¦¬í•˜ì—¬ 300weië¥¼ ëŒë ¤ ë°›ì•˜ë‹¤.

#### [ì»¨íŠ¸ë™íŠ¸ì£¼ì†Œ](https://ropsten.etherscan.io/address/0x523d10ace8773ce9fc1bebc2f3e811fdcb9cdf73) ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤

---

## ë§ˆì¹˜ë©°

ê°€ìœ„ë°”ìœ„ë³´ ë¼ëŠ” ê°„ë‹¨í•œ ê²Œì„ì„ ì§ì ‘ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¡œ ì‘ì„±í•˜ê³  ë°°í¬ í•´ë³´ì•˜ëŠ”ë° ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ê°€ ë¸”ë¡ì²´ì¸ì— ì˜¬ë¼ê°€ê²Œ ë˜ë©´ ì‘ì„±í•œ ì½”ë“œë¥¼ ë°”ê¿€ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë°°í¬í•˜ê¸° ì „ì— ë§ì€ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì¹˜ê³  ë³´ì™„ì ì„ ì°¾ê³  ë°°í¬í•´ì•¼ë§Œ í•œë‹¤. ì¼ë°˜ ì›¹ê²Œì„ì²˜ëŸ¼ ê²Œì„í•˜ë©´ ì§€ê³  ëë‚˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê°œì¸ì˜ ëˆì„ ì§€ë¶ˆ í•˜ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ì¢€ ë” ì •êµí•˜ê²Œ ì§œê³  ë°°í¬í•´ì•¼ ë‹¤ë¥¸ í•´ì»¤ë¡œë¶€í„° ìœ„í—˜ì„ ë°©ì§€ í•  ìˆ˜ê°€ ìˆë‹¤. ë³´ì•ˆì´ ì¤‘ìš”ì‹œ ë˜ëŠ” ê°’ë“¤ì„ ì˜ ê´€ë¦¬í•˜ì—¬ ë°°í¬í•˜ê³  ê·¸ë ‡ë‹¤ê³  ë§ì€ ë°ì´í„°ë¥¼ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— ë‹´ê²Œ ë˜ë©´ ê·¸ë§Œí¼ ê°€ìŠ¤ ì†Œë¹„ê°€ í¬ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ìµœì í™” í•˜ëŠ” ê²ƒë„ ìŠì§€ ë§ì•„ì•¼ í•œë‹¤. ì´ ê²Œì„ì€ ì˜¤ì§ ë°©ì¥ë§Œì´ payoutì„ ì‹¤í–‰í•˜ì—¬ ê¸ˆì•¡ì„ ë°°ë¶„í•˜ëŠ” êµ¬ì¡° ì´ì§€ë§Œ, ë§Œì•½ ë°©ì¥ì´ ì•…ì˜ì ì¸ ë§ˆìŒì„ ê°€ì§€ê³  ì°¸ì—¬ìì˜ ê°’ì„ í™•ì¸í•˜ê³  ë³¸ì¸ì´ ë¶ˆë¦¬í•˜ë©´ ì‹¤í–‰í•˜ì§€ ì•Šê²Œ ë˜ë©´ ì´ ì»¨íŠ¸ë™íŠ¸ ì•ˆì— ìˆëŠ” ëˆì€ ì˜ì›íˆ ë¬µíˆê²Œ ë˜ë¯€ë¡œ ë°©ì¥ë§Œ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì°¸ì—¬ìê°€ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ë„ ì‹œë„í•´ë³¼ë§Œ í•˜ë‹¤. ë˜í•œ ì°¸ì—¬ìì˜ ê°’ë„ í•´ì‹œí™” í•˜ì—¬ ë°©ì¥ë„ í™•ì¸ ëª»í•˜ê²Œ í•˜ë©´ êµ³ì´ ë§ˆì§€ë§‰ ì°¸ì—¬ìê°€ ê²°ê³¼ë¥¼ í™•ì¸ ì•ˆí•˜ë”ë¼ë„ ë°©ì¥ë„ ê¶ê¸ˆí•´ì„œ í™•ì¸í•˜ì§€ ì•Šì„ê¹Œ í•œë‹¤. ë‹¤ìŒì— ì´ëŸ° ë¹„ìŠ·í•œ ê²Œì„ì´ë‚˜ ë‹¤ë¥¸ ê²ƒì„ ë§Œë“¤ë•ŒëŠ” ì´ë¶€ë¶„ì„ ìƒê°í•˜ì—¬ ë” ë‚˜ì€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§Œë“¤ì–´ ë´ì•¼ê² ë‹¤.
